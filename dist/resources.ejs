<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <%- include('partials/head.ejs', { data: { title: 'Resources' }}) %>
</head>

<body>

  <div class="wrapper">

    <%- include('partials/header.ejs', { data: { state: 'resources' }}) %>

    <section class="text-center">
      <div style="padding: 50px 20px 40px; background: rgba(0,44,119,0.9);">
        <h3 class="text-white title-font">Get to know the movement<br>and what YOU can do for our country</h3>
      </div>
    </section>

    <section class="section-margin ptb-80">
      <div id="main" class="site-main" style="transform: none;">


        <div class="container" style="transform: none;">
          <div class="row" style="transform: none;">
            <div id="main-content" class="main-content" style="transform: none; padding-top: 30px;">

              <div id="primary" class="content-area col-xs-12 col-sm-8 col-sm-offset-2">

                <div id="content" class="site-content" role="main">
                  <article id="post-1165" class="post clearfix post-1165 page type-page status-publish hentry">
                    <header class="entry-header">
                      <h1 class="entry-title tbWow fadeIn" style="visibility: visible; animation-name: fadeIn;">Call My Senator</h1>
                    </header>
                    <div class="entry-content clearfix">
                      <p>Call your Senators and Representative by submitting your zip code below.  This will return their names, clickable phone numbers, and other information. If that doesnâ€™t work for any reason, you can still look them up online: <a href="http://www.senate.gov/general/contact_information/senators_cfm.cfm" target="_blank">Senators</a> and <a href="http://www.house.gov/representatives/find/" target="_blank">Representatives</a>.</p>
                      <p>If you would like to volunteer even more actively, join us <a href="http://fightforbetter.org/volunteer/" target="_blank">here</a>.</p>

                      <form @submit="getByZip" class="form form-inline" style="margin: 10px 0 20px;">
                        <input type="text" v-model="zip" class="form-control input-lg" style="margin-bottom: 5px;" placeholder="Zip Code"/>
                        <button type="submit" class="btn-zip" style="margin-bottom: 5px;">Get Results</button>
                      </form>

                      <div v-if="submitted & results.length === 0" class="text-muted">No results. Please check your zip code and try again.</div>



                      <div v-for="result in results">

                        <div class="media" style="position: relative; padding-left: 160px; margin: 10px 0; min-height: 160px;">
                          <img class="portrait-img"
                            :src="'https://www.govtrack.us/data/photos/' + result.govtrack_id + '-200px.jpeg'"
                            :alt="result.last_name">
                          <div class="media-body">
                            <h4>
                              <span v-text="result.title"></span>&nbsp;<span v-text="result.first_name"></span>&nbsp;<span v-text="result.last_name"></span>
                              <br/>
                              <a :href="'tel:' + result.phone" v-text="result.phone" style="color: #0d8ad9;"></a>
                            </h4>
                            <div style="margin: 5px 0" v-if="result.website">
                              <a :href="result.website" target="_blank" v-text="result.website" style="color: #043174;"></a>
                            </div>
                            <a :href="'https://facebook.com/' + result.facebook_id" v-if="result.facebook_id" target="_blank" style="margin-right: 10px;">
                              <i class="fa fa-lg fa-facebook-official" style="color: #3b5998;"></i>
                            </a>
                            <a :href="'https://twitter.com/' + result.twitter_id" v-if="result.twitter_id" target="_blank" style="margin-right: 10px;">
                              <i class="fa fa-lg fa-twitter" style="color: #1da1f2;"></i>
                            </a>
                            <!-- <pre>{{ result }}</pre> -->
                          </div>
                        </div>

                      </div>
                    </div>
                  </article>
                </div>
                <!-- #content -->
              </div>
              <!-- #primary -->
            </div>
            <!-- #main-content -->


          </div>
        </div>
      </div>
      <!-- #main -->
    </section>

    <%- include('partials/footer.ejs') %>

  </div>

  <script src="js/vendor/jquery-1.12.4.min.js"></script>
  <script src="js/bootstrap.min.js"></script>

  <script src="https://unpkg.com/vue/dist/vue.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    console.log('running')
    var app = new Vue({
      el: '#main',
      data: {
        zip: '',
        submitted: false,
        results: []
      },
      methods: {
        getByZip: function (e) {
          if (e) e.preventDefault()
          // var url = 'https://congress.api.sunlightfoundation.com/legislators/locate?apikey=d9733fd4fa5a43cda9885da876a67848&zip=' + this.zip
          var url = 'https://congress.api.sunlightfoundation.com/legislators/locate?apikey=fcc49828184a400497a701cb43130c19&zip=' + this.zip
          axios.get(url)
          .then(function (res) {
            this.submitted = true
            this.results = res.data.results
          }.bind(this))
          .catch(function (err) {
            console.log('err', err)
          })
        }
      }
    })
  </script>

</body>

</html>
